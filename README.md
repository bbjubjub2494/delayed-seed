# Delayed-seed

**NOTE: The author is not a cryptographer. Don't use this in production, it's very possible you'll lose your coins if you do so.**

This is an implementation of a private key derivation with a checkpoint as described [in this document](https://gist.github.com/phyro/0fbe1bb4ddada0d6cc9b46ff1aaf600c).

The document describes the simplest possible scheme. More complicated/fancy schemes are possible by having multiple checkpoint inputs, perhaps even such that are split into multiple messages which can be reconstructed with a 3/5 or similar i.e. [using something like this](https://github.com/cronokirby/seed-split). I'm not sure how creative we can get, I guess it's an open problem.

The scheme starts with some seed words and uses these as the genesis for a hashchain that is generated from it. The hashchain has a certain length, for example 10000, and the last chain hash is transformed into real seed words which we call "Delayed seed words". Why the name delayed? Because the idea is that the hashchain takes a certain time to compute.

Here's an example
```
    H0        H1                H2                 H3              H10001
SeedWords -> H(H0) -> H(H1 || CheckpointInput) -> H(H2) -> ... -> H(H10000) -> DelayedSeedWords
```

We can see the hashchain starts with seed words and ends with new seed words. There's another element at `H2` position that we haven't mentioned yet called a `CheckpointInput`. This is a special input that is generated by the program when we create a delayed seed word and is required for its recovery. The idea is to save the CheckpointInput to some online source which would notify you if it was ever accessed.

### Naive notifier

A naive notifier implementation would be to create a protonmail account with the username and password provided by this program and self-send an email with CheckpointInput as the email content. This way, we know the input to correctly continue the hashchain so we can recover the delayed seed words. The way this works as a notifier is because if we install protonmail on our phone and login with this account, we receive a notification for every login attempt which gives us the chance to spot when an attacker is trying to recover the delayed seed words and gives us time to transfer our coins to a new wallet.

Why is email a naive way of notification? Because anyone logging in is able to delete the email or the whole account. This means we could lose the CheckpointInput which is required for deriving our real seed words. We'd need a read-only view of the information to protect against this. Since this is just a toy prototype, we don't care about these details.


### Usage


##### Create delayed seed words

```
$ ./dsw create "surface junk brother track earn quarter sphere they lottery museum across point dry accident baby able broccoli labor open estate alert spice aim girl"
Email username: dsw01c786a421017345a525acbd5eac4
Email password: a0851f6045a400523d7ee60b60fb7d1d

Generated checkpoint input:  2bc2c963dd9c4641fab7bc45f6fee83cbf9da2f8ae0c65536f14b42641bd65ca

Save the checkpoint input to your notifier.

Protonmail notifier:
1. Create a protonmail account with the username and password described above
2. Send an email to the same account you created with the content being the checkpoint input as described above
3. Download and login to protonmail app on your Android phone

This way, if you're logged into this account on your mobile, you'll get notified whenever someone accesses the email to read the secret checkpoint input.

Once you're done, please copy the checkpoint input and paste it here to confirm you've copied the right thing. Checkpoint input:
	
2bc2c963dd9c4641fab7bc45f6fee83cbf9da2f8ae0c65536f14b42641bd65ca

Real seed words:  [slide between mushroom cream genuine nephew hunt opera all sense where fault tree drop weapon vicious economy explain useless mosquito sustain upper nut gap]
```

##### Recover delayed seed words

```
$ ./dsw recover "surface junk brother track earn quarter sphere they lottery museum across point dry accident baby able broccoli labor open estate alert spice aim girl"
Email username: dsw01c786a421017345a525acbd5eac4
Email password: a0851f6045a400523d7ee60b60fb7d1d

Please get the checkpoint input from your notifier (i.e. email) and paste it below.

Example Protonmail notifier recovery:
1. Login to a protonmail account with the username and password described above
2. Find the email with the checkpoint input string and paste the string to the terminal
3. Wait for the program to compute the remaining hashchain

Paste the checkpoint input here:
2bc2c963dd9c4641fab7bc45f6fee83cbf9da2f8ae0c65536f14b42641bd65ca

Real seed words:  [slide between mushroom cream genuine nephew hunt opera all sense where fault tree drop weapon vicious economy explain useless mosquito sustain upper nut gap]
```

**NOTE: The author is not a cryptographer. Don't use this in production, it's very possible you'll lose your coins if you do so.**